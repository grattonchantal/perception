setwd("/Users/Chantal/Documents/Doctoral/Courses/Spring 2017/LIN 245/perception/data/")
library(languageR)
library(lme4)
library(tidyverse)
library(ggplot2)
df = read.csv("complete_trials_reduced.csv")
head(df)
summary(df)
nrow(df)
summary(df$topic)
crit_df <- df[df$filler == "False",]
head(crit_df)
summary(crit_df)
nrow(crit_df)
unique(crit_df$topic)
crit_df$topic <- factor(crit_df$topic)
unique(crit_df$topic)
crit_df$prosody <- factor(crit_df$prosody)
unique(crit_df$prosody)
summary(crit_df$topic)
table(crit_df$topic, crit_df$prosody)
table(crit_df$prosody, crit_df$adj_1_pole)
table(crit_df$agree)
summary(crit_df$agree)
table(crit_df$agree, crit_df$prosody)
mean(crit_df$agree[crit_df$prosody=="affirmative"])
mean(crit_df$agree[crit_df$prosody=="contrastive"])
ggplot(crit_df, aes(x=agree)) +
geom_histogram(binwidth=.01) +
xlab("Perceived agreement (%)") +
ylab("Overall responses")
ggplot(crit_df, aes(x=prosody,y=agree,color=adj_1_pole)) +
geom_point(size=.5) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=as.factor(workerid),y=agree,color=adj_1_pole)) +
geom_boxplot(alpha=.4) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree,color=adj_1)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
theme_set(theme_bw())
crit_df <- df[df$filler == "False",]
crit_df$topic <- factor(crit_df$topic)
crit_df$prosody <- factor(crit_df$prosody)
table(crit_df$topic, crit_df$prosody)
table(crit_df$prosody, crit_df$adj_1_pole)
table(crit_df$topic+crit_df$adj_2, crit_df$prosody)
table(crit_df$topic:crit_df$adj_2, crit_df$prosody)
table(crit_df$topic,crit_df$adj_2, crit_df$prosody)
table(crit_df$topic/crit_df$adj_2, crit_df$prosody)
table(crit_df$topic:crit_df$adj_2, crit_df$prosody)
table(crit_df$topic, crit_df$prosody)
table(crit_df$adj_2, crit_df$prosody)
crit_df$adj_2 <- factor(crit_df$adj_2)
table(crit_df$adj_2, crit_df$prosody)
setwd("/Users/Chantal/Documents/Doctoral/Courses/Spring 2017/LIN 245/perception/results/Rscripts")
setwd("/Users/Chantal/Documents/Doctoral/Courses/Spring 2017/LIN 245/perception/results/Rscripts")
library(languageR)
library(lme4)
library(tidyverse)
library(ggplot2)
theme_set(theme_bw())
table(crit_df$agree)
summary(crit_df$agree)
table(crit_df$agree, crit_df$prosody)
ggplot(crit_df, aes(x=agree)) +
geom_histogram(binwidth=.01) +
xlab("Perceived agreement (%)") +
ylab("Overall responses")
ggplot(crit_df, aes(x=prosody,y=agree,color=adj_1_pole)) +
geom_point(size=.5) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)")
ggplot(crit_df, aes(x=prosody,y=agree)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)")
ggplot(crit_df, aes(x=prosody,y=agree,color=adj_1_pole)) +
geom_point(size=.5) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree,color=adj_1_pole)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree,color=adj_1_pole)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "Effect of prosodic contour and adjective polarity on percieved agreement", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=adj_1_pole,y=agree,color=prosody)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "Effect of prosodic contour and adjective polarity on percieved agreement", x = "Adjective polarity", y = "Percieved agreement (%)", color = "Prosodic contour")
ggplot(crit_df, aes(x=prosody,y=agree,color=adj_1)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
summary(lm(agree~as.factor(prosody)*as.factor(adj_1_pole) + as.factor(workerid),data=sans22))
summary(lm(agree~as.factor(prosody)*as.factor(adj_1_pole) + as.factor(workerid),data=crit_df))
summary(lmer(agree ~ prosody*adj_1_pole +  (1|workerid), data=crit_df, REML=F)
summary(lmer(agree ~ prosody*adj_1_pole + (1|workerid), data=crit_df, REML=F))
m = lmer(agree ~ prosody*adj_1_pole + (1|workerid), data=crit_df, REML=F)
summary(m)
m = lmer(agree ~ prosody*adj_1_pole +  (1|workerid), data=crit_df, REML=F)
summary(m)
cor(fitted(m),crit_df$agree)^2
summary(lmer(agree ~ prosody*adj_1_pole +  (1|workerid), data=crit_df, REML=F))
cor(fitted(lmer(agree ~ prosody*adj_1_pole +  (1|workerid), data=crit_df, REML=F)),crit_df$agree)^2
cor(fitted(lm(agree ~ prosody, data=crit_df, REML=F)),crit_df$agree)^2
cor(fitted(lm(agree ~ prosody, data=crit_df)),crit_df$agree)^2
cor(fitted(lmer(agree ~ prosody + (1|workerid), data=crit_df, REML=F)),crit_df$agree)^2
cor(fitted(lmer(agree ~ (1|workerid), data=crit_df, REML=F)),crit_df$agree)^2
ggplot(crit_df, aes(x=prosody,y=agree,color=adj_1)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=adj_1,color=agree)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=adj_1,color=agree)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=agree,y=adj_1,color=prosody)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=adj_1,y=agree,color=prosody)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=adj_1,y=agree,color=prosody)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=T) +
labs(title = "XYZ", x = "Adjective", y = "Percieved agreement (%)", color = "Prosodic contour")
ggplot(crit_df, aes(x=adj_1,y=agree,color=prosody)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=F) +
labs(title = "XYZ", x = "Adjective", y = "Percieved agreement (%)", color = "Prosodic contour")
ggplot(crit_df, aes(x=as.factor(workerid),y=agree,color=prosody)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=F) +
labs(title = "XYZ", x = "Adjective", y = "Percieved agreement (%)", color = "Prosodic contour")
ggplot(crit_df, aes(x=as.factor(workerid),y=agree,color=adj_1_pole)) +
geom_boxplot(alpha=.4) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=as.factor(workerid),y=agree,color=prosody)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=F) +
labs(title = "Effect of subject and prosodic contour on percieved agreement", x = "Subject", y = "Percieved agreement (%)", color = "Prosodic contour")
ggplot(crit_df, aes(x=as.factor(workerid),y=agree,color=prosody)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=F) +
labs(title = "Effect of subject and prosodic contour on percieved agreement", x = "Subject", y = "Percieved agreement (%)", color = "Prosodic contour")
ggplot(crit_df, aes(x=as.factor(workerid),y=agree,color=adj_1_pole)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=F) +
labs(title = "Effect of subject and prosodic contour on percieved agreement", x = "Subject", y = "Percieved agreement (%)", color = "Prosodic contour")
ggplot(crit_df, aes(x=as.factor(workerid),y=agree,color=adj_1_pole)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=F) +
labs(title = "Effect of subject and prosodic contour on percieved agreement", x = "Subject", y = "Percieved agreement (%)", color = "Prosodic contour")
ggplot(crit_df, aes(x=as.factor(workerid),y=like,color=prosody)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=F) +
labs(title = "Effect of subject and prosodic contour on percieved agreement", x = "Subject", y = "Percieved evaluation (%)", color = "Prosodic contour")
ggplot(crit_df, aes(x=as.factor(workerid),y=happy,color=prosody)) +
geom_violin() +
geom_boxplot(alpha=.4,notch=F) +
labs(title = "Effect of subject and prosodic contour on percieved agreement", x = "Subject", y = "Percieved evaluation (%)", color = "Prosodic contour")
ggplot(crit_df, aes(x=prosody,y=adj_1_pole,color=(agree, like))) +
ggplot(crit_df, aes(x=prosody,y=adj_1_pole,color=(agree + like))) +
geom_boxplot(alpha=.4) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=adj_1_pole,color=(agree))) +
geom_boxplot(alpha=.4) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree,color=adj_1_pole)) +
geom_boxplot(alpha=.4) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree + like,color=adj_1_pole)) +
geom_boxplot(alpha=.4) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree*like,color=adj_1_pole)) +
geom_boxplot(alpha=.4) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=agree,color=adj_1_pole)) +
geom_boxplot(alpha=.4) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,y=(agree, like),color=adj_1_pole)) +
ggplot(crit_df, aes(x=prosody,y=(agree + like),color=adj_1_pole)) +
geom_boxplot(alpha=.4) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=prosody,color=adj_1_pole)) +
geom_boxplot(alpha=.4) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=agree,color=adj_1_pole)) +
geom_boxplot(alpha=.4) +
labs(title = "XYZ", x = "Prosodic contour", y = "Percieved agreement (%)", color = "Adjective polarity")
summary(lmer(agree ~ prosody*adj_1_pole +  (1|workerid), data=crit_df, REML=F))
cor(fitted(lmer(agree ~ prosody*adj_1_pole + (1|workerid), data=crit_df, REML=F)),crit_df$agree)^2
ggplot(crit_df, aes(x=adj_1_pole,y=like,color=prosody)) +
geom_boxplot(alpha=.4) +
labs(title = "Effect of prosodic contour and adjective polarity on percieved evaluation", x = "Prosodic contour", y = "Percieved evaluation (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=adj_1_pole,y=friendly,color=prosody)) +
geom_boxplot(alpha=.4) +
labs(title = "Effect of prosodic contour and adjective polarity on percieved friendliness", x = "Prosodic contour", y = "Percieved friendliness (%)", color = "Adjective polarity")
ggplot(crit_df, aes(x=adj_1_pole,y=happy,color=prosody)) +
geom_boxplot(alpha=.4) +
labs(title = "Effect of prosodic contour and adjective polarity on percieved happiness", x = "Prosodic contour", y = "Percieved happiness (%)", color = "Adjective polarity")
summary(lmer(agree ~ prosody*adj_1_pole + like + friendly + happy + (1|workerid), data=crit_df, REML=F))
cor(fitted(lmer(agree ~ prosody*adj_1_pole + like + friendly + happy + (1|workerid), data=crit_df, REML=F)),crit_df$agree)^2
summary(lm(agree ~ prosody*adj_1_pole + like + friendly + happy, data=crit_df, REML=F))
summary(lm(agree ~ prosody*adj_1_pole + prosody*like + prosody*friendly + prosody*happy, data=crit_df, REML=F))
summary(lm(agree ~ prosody*adj_1_pole + like + friendly + happy + as.factor(workerid), data=crit_df, REML=F))
summary(lm(agree ~ prosody*adj_1_pole + as.factor(like) + friendly + happy + as.factor(workerid), data=crit_df, REML=F))
summary(lm(agree ~ as.factor(prosody)*adj_1_pole + like + friendly + happy + as.factor(workerid), data=crit_df, REML=F))
